# ssh-terminal

## やること

SSH ターミナルソフトの原型を作る。

## 背景

とあるベンダーから提供された「通信系アプライアンス製品にコマンドを投入するシステム」が
レガシー化しており、日頃からシステム障害対策等に時間を取られている。

障害対策のひとつとしてターミナルソフトの TeraTerm を利用したコマンド投入で
業務を自動化しているが、いくつかの制約を乗り越える必要がある。
具体的には以下

- TeraTerm 独自のプログラミング言語「TeraTerm Language」を使う必要がある。
  言語使用を気軽に試す環境があれば、キャッチアップにはそこまで時間が  
  かからないが、「手軽に試す環境」は用意されていない。
  端的に言えば、学習環境を準備できない or 学習環境を用意できない為
  学習コストが比較的に高い。加えて後述で記載するが、コマンド投入作業を自動化するには
  投入対象の装置に対する知見や経験が必要になる。

- テストを自動化することができない
  前述の通り、「手軽に試す環境」が用意もしくは準備することができない為
  テストができない。仮に「手軽に試す環境」が用意できたとしても
  TeraTerm Language にはテスト機能が存在しない為、自身で専用のテストを実装する必要がある。
  現在のテストは「投入先装置に関する知見」を持った上でコマンドの投入結果が求めている結果と正しいかどうかをチェックしている。

## なにを作るのか

まずはじめに原型となるターミナルソフトの機能を作成する。
モデルは TeraTerm

今回の問題を解決する上で重要なことは  
クライアント端末から特定のコマンドリストをテンプレート(以下、コマンドテンプレート)にすることで
コマンド投入を自動化することにある。

その前に対象装置との接続機能を担保する。
現在の業務では接続には主に telnet を用いた接続を行っているが
テストする上で telnet は危険である為、SSH を用いてテストを行う。

要するに作成するアプリケーションとしては
SSH 接続を用いて対象端末に接続を行い、指定のコマンドテンプレートで
装置にコマンドを投入する。このとき出力結果に応じて他のコマンドを投入できるようにする。

## 実際に作成する機能

### SSH で対象端末に接続する

SSH 接続に必要な情報は５つある。具体的には

- ユーザ名
- パスワード
- IP アドレスまたはホスト名
- ポート番号
- 秘密鍵

このうち秘密鍵については実装を見送る。見送る理由としては
実際の業務では秘密鍵を利用しない為

### コマンド入力を受け付ける

ユーザ側で決められたコマンドテンプレートを投入できるようにするのが最終目標ではあるが
まずは TeraTerm を踏襲して接続状態に入ったあとは好きにコマンドを入力できるような仕組みを作る。

### 標準出力からコマンドの結果を受け付ける

投入されたコマンドに応じてコマンドを投入された装置は
処理結果を返す為、それを受け付けて CLI 上に表示することを第一段階とする。

### SSH 接続を切断する

端末から接続を切るパターンとクライアントから接続を切るパターンがある。
まずは、端末から接続を切るパターンを実現する。
